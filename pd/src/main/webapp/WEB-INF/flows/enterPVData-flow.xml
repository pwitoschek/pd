<?xml version="1.0" encoding="UTF-8"?>
<flow xmlns="http://www.springframework.org/schema/webflow"
	xmlns:xsi="http://www.w3.org/2001/XMLSchema-instance" xmlns:flow="http://www.springframework.org/schema/webflow-config"
	xsi:schemaLocation="http://www.springframework.org/schema/webflow
	http://www.springframework.org/schema/webflow/spring-webflow-2.4.xsd"
	start-state="startEnterPVData">

	<view-state id="startEnterPVData"
		view="/WEB-INF/flows/photovoltaik/startEnterPVData.jsp" model="flowScope.tagesertrag">
		<!-- muss ich hier Ã¼berhaupt Beans als Variablen deklarieren?! das sollte
			 doch der Spring Container automatisch injizieren?!
			 -->
		<var name="flowScope.tagesertrag" class="de.app.pd.entities.pv.Tagesertrag"/>
		<var name="flowScope.tagesverbrauch" class="de.app.pd.entities.pv.Tagesverbrauch"/>
		<on-entry>
			<evaluate expression="tagesertrag.setInitValues()" result="flowScope.tagesertrag" />
		</on-entry>
		<transition on="submit" to="enterVerbrauch"></transition>
		<transition on="cancel" to="startEnterPVData"></transition>
	</view-state>
	
	<view-state id="enterVerbrauch" 
		view="/WEB-INF/flows/photovoltaik/startEnterVerbrauch.jsp" model="flowScope.tagesverbrauch">
		<on-entry>
			<evaluate expression="tagesverbrauch.setInitValues()" result="flowScope.tagesverbrauch" />
		</on-entry>
		<transition on="submit" to="reviewEnterPVData"></transition>
		<transition on="back" to="startEnterPVData"></transition>
	</view-state>

	<view-state id="reviewEnterPVData" view="/WEB-INF/flows/photovoltaik/reviewEnterPVData.jsp">
		<transition on="submit" to="savePVData"></transition>
		<transition on="back" to="enterVerbrauch"></transition>
	</view-state>

	<action-state id="savePVData">
		<evaluate expression="dataAccessObjectImpl.addTagesverbrauch(tagesverbrauch)"></evaluate>
		<evaluate expression="dataAccessObjectImpl.addTagesertrag(tagesertrag)"></evaluate>
		<transition on="success" to="enterPVDataSuccess"/>
		<transition on="failure" to="enterPVDataFailure"/>
	</action-state>

	<end-state id="enterPVDataSuccess"></end-state>
	<end-state id="enterPVDataFailure"></end-state>

</flow>